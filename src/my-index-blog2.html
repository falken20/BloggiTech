<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">

<!-- Añadimos compoenente que viene para en linea inferior para sacar array (    <template is="dom-repeat" items="...)-->

<link rel="import" href="../bower_components/polymer/lib/elements/dom-repeat.html">

<dom-module id="my-index-blog2">
  <template>
    <style>
      :host {  /* Para referenciar el estilo de mi componente */
        display: inline-block;
        background-color: white;
        width: -moz-available;
        align-items: center;
      }
      .container {
        max-width: 500px !important;
      }      
    </style>

<div class="row">
  <template is="dom-repeat" items="[[posts]]">
    <div class="col-xs-6 col-md-3">
      <a href="#" class="thumbnail">
        <img src="[[item.urlfoto]]" style="width:250px;height:160px;">
        <center><h6>[[item.titulo]]</h6></center>
      </a>
    </div>
  </template>
</div>

<div class="container">
  <div id="myCarousel" class="carousel slide" data-ride="carousel">
    <!-- Wrapper for slides -->
    <div class="carousel-inner">
      <div class="item active">
        <img src="https://s3-eu-west-1.amazonaws.com/bucket-posts/safetycheckmobielcarousel.jpg" alt="Los Angeles" style="width:90%;height:90%">
      </div>

      <div class="item">
        <img src="https://s3-eu-west-1.amazonaws.com/bucket-posts/Oreo.png" alt="Chicago" style="width:90%;height:90%">
      </div>
    
      <div class="item">
        <img src="https://s3-eu-west-1.amazonaws.com/bucket-posts/runjump.jpeg" alt="New york" style="width:90%;height:90%">
      </div>
    </div>

    <!-- Left and right controls -->
    <a class="left carousel-control" href="#myCarousel" data-slide="prev">
      <span class="glyphicon glyphicon-chevron-left"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#myCarousel" data-slide="next">
      <span class="glyphicon glyphicon-chevron-right"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>
</div>


  </template>
    <script>
      /* Lo siguiente es porque heredamos del Polymer element. Se podria hacer como en my-view poniendo class...
      class MyView1 extends Polymer.Element {
        static get is() { return 'my-view1'; }
      }
      */
      Polymer({
        is: 'my-index-blog2',
        properties: {
          url: {
            type: String,
            value: "https://api.mlab.com/api/1/databases/dbbootcamp/collections/posts"
          },
          apiKey: {
            type: String,
            value: "?apiKey=CQjEP7tpIq0_e_u0XbMU2o1Xgt8fgB74"
          },
          posts: {
            type: Array,
            notify: true //Automáticamente refresca cuando cambia algo...(se supone)
          }
        },
        listeners: {
        },
        ready: function() {
          var peticion = new XMLHttpRequest();
          peticion.open("GET", this.url + this.apiKey, false);
          peticion.setRequestHeader("Content-Type", "application/json");
          peticion.send();
          this.posts = JSON.parse(peticion.responseText);
          sessionStorage["posts"] = peticion.responseText;
          console.log("ROD: " + peticion.responseText);
        },
        obtenerPosts: function() {
          var peticion = new XMLHttpRequest();
          peticion.open("GET", this.url + this.apiKey, false);
          peticion.setRequestHeader("Content-Type", "application/json");
          peticion.send();
          this.posts = JSON.parse(peticion.responseText);
          sessionStorage["posts"] = peticion.responseText;
          console.log("ROD: " + peticion.responseText);
        }
      })
    </script>
</dom-module>
